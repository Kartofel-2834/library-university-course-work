import{b as R,E as a,u as p}from"./books-DlBjYXpd.js";import{h as u}from"./PotIcon-BaTU6f8o.js";import{D as v,s as A,G as b,i as m,r as C,c as n}from"./index-C1LIssbb.js";var r=(t=>(t.PENDING="pending",t.REJECTED="rejected",t.ACCEPTED="accepted",t))(r||{});const S=[{id:1,reader:v.find(t=>t.type===A.READER),book:R.find(t=>t.status===a.REQUESTED),status:r.PENDING,createdDate:u(),comment:null}],P=b("requests",()=>{const t=m(),i=p(),o=C([...S]),E=n(()=>o.value.filter(e=>e.status===r.ACCEPTED)),d=n(()=>o.value.filter(e=>e.status===r.PENDING)),c=n(()=>o.value.filter(e=>e.status===r.REJECTED));function f(e){if(!t.isReader)throw new Error("Только читатели могут запрашивать книги");i.changeBookStatus(e.book,a.REQUESTED),o.value=[...o.value.filter(s=>s.id!==e.id),e]}function l(e){if(!t.isAdmin)throw new Error("Только админы могут отклонять выдачу книги");i.changeBookStatus(e.book,a.AVAILABLE),e.status=r.REJECTED,o.value=[...o.value.filter(s=>s.id!==e.id),e]}function k(e){if(!t.isAdmin)throw new Error("Только админы могут принимать выдачу книги");e.book.status=a.OCCUPIED,e.book.issueDate=u(),e.book.reader=e.reader,i.addBook(e.book),e.status=r.ACCEPTED,o.value=[...o.value.filter(s=>s.id!==e.id),e]}function D(e){i.changeBookStatus(e.book,a.AVAILABLE),o.value=o.value.filter(s=>s.id!==e.id)}return{requests:o,acceptedRequests:E,pendingRequests:d,rejectedBooks:c,addRequest:f,rejectRequest:l,acceptRequest:k,deleteRequest:D}});export{r as E,P as u};
