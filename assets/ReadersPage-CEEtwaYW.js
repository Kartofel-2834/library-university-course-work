import{d as M,c as D,o as R,f as b,e as l,n as s,t as A,g as i,u as a,E as I,_ as C,w as B,a as k,b as p,h as y,s as F,i as P,r as z,j as S,F as N,l as O,k as U}from"./index-BCUyAAPs.js";import{P as T,B as V,C as w}from"./BaseHeader-DK_6ZRXn.js";import{a as L,E as f}from"./PotIcon-Dxm1-QIH.js";import{u as h,P as $,a as j}from"./PotInputBase-UzME30i5.js";const Q=M({__name:"ReaderCard",props:{reader:{}},emits:["delete"],setup(_,{emit:c}){const m=_,v=c,r=D(()=>[m.reader.surname,m.reader.name,m.reader.fathername].join(" "));function n(){v("delete",m.reader)}return(o,g)=>(R(),b("div",{class:s([o.$style.ReaderCard,"reader-card"])},[l("div",{class:s(o.$style.content)},[l("div",{class:s(o.$style.studentId)},A(o.reader.studentId),3),l("div",{class:s(o.$style.fullname)},A(r.value),3)],2),l("div",{class:s(o.$style.actions)},[i(L,{color:a(I).DANGER,icon:"delete",square:"",title:"Удалить",onClick:n},null,8,["color"])],2)],2))}}),G="_ReaderCard_wkvmi_348",Y="_content_wkvmi_357",H="_studentId_wkvmi_363",q="_fullname_wkvmi_380",J={ReaderCard:G,content:Y,studentId:H,fullname:q},K={$style:J},W=C(Q,[["__cssModules",K]]),X=M({__name:"ReaderAddForm",props:{isOpen:{type:Boolean,default:!1}},emits:["close","submit"],setup(_,{emit:c}){const m=_,v=c,r=j(),n=h({login:[r.REQUIRED()],password:[r.REQUIRED()],name:[r.REQUIRED()],surname:[r.REQUIRED()],fathername:[r.REQUIRED()],studentId:[r.REQUIRED()]}),o=D(()=>n.values.value);B(()=>m.isOpen,()=>{m.isOpen&&n.change({})});function g(){v("close")}function E(){n.validate()&&v("submit",d(n.values.value))}function d(e){return{id:Math.floor(Math.random()*1e6),type:F.READER,login:e.login??"",password:e.password??"",name:e.name??"",surname:e.surname??"",fathername:e.fathername??"",studentId:Number(e.studentId)}}return(e,t)=>(R(),k(T,{class:s([e.$style.ReaderAddForm,"reader-add-form"]),"is-open":e.isOpen,onClose:g},{default:p(()=>[l("div",{class:s(e.$style.content)},[l("div",{class:s(e.$style.title)},"Добавление читателя",2),l("div",{class:s(e.$style.fieldsList)},[l("div",{class:s(e.$style.field)},[l("div",{class:s(e.$style.label)},"Имя",2),i($,{value:o.value.name,size:a(f).SMALL,onInput:t[0]||(t[0]=u=>a(n).changeField("name",String(u)))},null,8,["value","size"])],2),l("div",{class:s(e.$style.field)},[l("div",{class:s(e.$style.label)},"Фамилия",2),i($,{value:o.value.surname,size:a(f).SMALL,onInput:t[1]||(t[1]=u=>a(n).changeField("surname",String(u)))},null,8,["value","size"])],2),l("div",{class:s(e.$style.field)},[l("div",{class:s(e.$style.label)},"Отчество",2),i($,{value:o.value.fathername,size:a(f).SMALL,onInput:t[2]||(t[2]=u=>a(n).changeField("fathername",String(u)))},null,8,["value","size"])],2),l("div",{class:s(e.$style.field)},[l("div",{class:s(e.$style.label)},"Номер студ. билета",2),i($,{value:o.value.studentId,size:a(f).SMALL,type:"number",onInput:t[3]||(t[3]=u=>a(n).changeField("studentId",String(u)))},null,8,["value","size"])],2),l("div",{class:s(e.$style.field)},[l("div",{class:s(e.$style.label)},"Логин",2),i($,{value:o.value.login,size:a(f).SMALL,onInput:t[4]||(t[4]=u=>a(n).changeField("login",String(u)))},null,8,["value","size"])],2),l("div",{class:s(e.$style.field)},[l("div",{class:s(e.$style.label)},"Пароль",2),i($,{value:o.value.password,size:a(f).SMALL,onInput:t[5]||(t[5]=u=>a(n).changeField("password",String(u)))},null,8,["value","size"])],2)],2),l("div",{class:s(e.$style.actions)},[i(L,{class:s(e.$style.submitButton),disabled:!a(n).isValid.value,onClick:E},{default:p(()=>t[6]||(t[6]=[y(" Сохранить ")])),_:1},8,["class","disabled"]),i(L,{class:s(e.$style.submitButton),color:a(I).SECONDARY,onClick:g},{default:p(()=>t[7]||(t[7]=[y(" Закрыть ")])),_:1},8,["class","color"])],2)],2)]),_:1},8,["class","is-open"]))}}),Z="_title_12zoh_348",x="_content_12zoh_357",ee="_fieldsList_12zoh_366",se="_image_12zoh_384",le="_imageInner_12zoh_388",ae="_imagePreview_12zoh_400",te="_imageInput_12zoh_408",ne="_field_12zoh_366",oe="_label_12zoh_418",ie="_textarea_12zoh_426",re="_actions_12zoh_453",de={title:Z,content:x,fieldsList:ee,image:se,imageInner:le,imagePreview:ae,imageInput:te,field:ne,label:oe,textarea:ie,actions:re},ue={$style:de},me=C(X,[["__cssModules",ue]]),ce={class:"container"},ve=M({__name:"ReadersPage",setup(_){const c=P(),m=z(""),v=z(!1),r=z(!1),n=z(null);function o(){if(n.value)try{c.deleteReader(n.value)}catch(d){E(d.message)}finally{n.value=null}}function g(d){try{c.addReader(d)}catch(e){E(e.message)}finally{r.value=!1}}function E(d){m.value=d,v.value=!0}return(d,e)=>a(c).isAdmin?(R(),b("div",{key:0,class:s(d.$style.ReadersPage)},[i(V,null,{title:p(()=>e[5]||(e[5]=[y(" Читатели ")])),default:p(()=>[i(L,{class:s(d.$style.addBookButton),size:[a(f).MEDIUM,a(f).SMALL],devices:[a(S).TABLET,a(S).MOBILE],color:a(I).PRIMARY_LIGHT,onClick:e[0]||(e[0]=t=>r.value=!0)},{default:p(()=>e[6]||(e[6]=[y(" Добавить читателя ")])),_:1},8,["class","size","devices","color"])]),_:1}),l("main",{class:s(d.$style.main)},[l("section",ce,[l("h1",{class:s(d.$style.title)},"Читатели",2),l("div",{class:s(d.$style.readersList)},[(R(!0),b(N,null,O(a(c).readers,t=>(R(),k(W,{key:t.id,reader:t,onDelete:e[1]||(e[1]=u=>n.value=u)},null,8,["reader"]))),128))],2)])],2),i(me,{"is-open":r.value,onClose:e[2]||(e[2]=t=>r.value=!1),onSubmit:g},null,8,["is-open"]),i(w,{"is-open":n.value!==null,"accept-color":a(I).DANGER,"reject-color":a(I).SECONDARY,onAccept:o,onReject:e[3]||(e[3]=t=>n.value=null)},{default:p(()=>e[7]||(e[7]=[y(" Вы уверены, что хотите удалить книгу из базы? ")])),_:1},8,["is-open","accept-color","reject-color"]),i(w,{"is-open":v.value,"reject-label":null,"accept-label":"Ок",onAccept:e[4]||(e[4]=t=>v.value=!1)},{default:p(()=>[y(A(m.value),1)]),_:1},8,["is-open"])],2)):U("",!0)}}),fe="_main_1fsw9_348",pe="_title_1fsw9_352",$e="_readersList_1fsw9_377",ye={main:fe,title:pe,readersList:$e},ge={$style:ye},ze=C(ve,[["__cssModules",ge]]);export{ze as default};
